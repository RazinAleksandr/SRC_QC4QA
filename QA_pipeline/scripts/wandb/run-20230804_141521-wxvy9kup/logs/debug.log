2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Current SDK version is 0.15.5
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Configure stats pid to 2725020
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Loading settings from /home/st-aleksandr-razin/.config/wandb/settings
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Loading settings from /home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/wandb/settings
2023-08-04 14:15:21,645 WARNING MainThread:2725020 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_CONFIG_DIR
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'QA_pipeline/scripts/test_script.py', 'program': '/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/test_script.py'}
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:_log_setup():507] Logging user logs to /home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/wandb/run-20230804_141521-wxvy9kup/logs/debug.log
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:_log_setup():508] Logging internal logs to /home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/wandb/run-20230804_141521-wxvy9kup/logs/debug-internal.log
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:init():547] calling init triggers
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {'model': {'name': '/raid/models/llama-7b-hf', 'load_in_8bit': True, 'peft_model_id': '/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/artifacts/experiments/train-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2', 'torch_dtype': 'fp16', 'device_map': 'cuda:1', 'padding_side': 'left'}, 'seed': 42, 'batch_size': 16, 'compute_metrics': True, 'data': {'dataset_name': 'RazinAleks/SO-Python_QA-Data_Science_and_Machine_Learning_class', 'max_prompt_length': 768, 'split': 'test', 'use_title': True, 'columns_to_save': ['Question', 'Answer', 'Title', 'Score', 'Users Score']}, 'generate_config': {'do_sample': True, 'max_new_tokens': 256, 'no_repeat_ngram_size': 2, 'top_k': 50, 'temperature': 0.8, 'top_p': 0.9, 'use_cache': True, 'num_return_sequences': 1}}
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:init():596] starting backend
2023-08-04 14:15:21,645 INFO    MainThread:2725020 [wandb_init.py:init():600] setting up manager
2023-08-04 14:15:21,647 INFO    MainThread:2725020 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-08-04 14:15:21,648 INFO    MainThread:2725020 [wandb_init.py:init():606] backend started and connected
2023-08-04 14:15:21,649 INFO    MainThread:2725020 [wandb_init.py:init():705] updated telemetry
2023-08-04 14:15:21,653 INFO    MainThread:2725020 [wandb_init.py:init():738] communicating run to backend with 60.0 second timeout
2023-08-04 14:15:22,128 INFO    MainThread:2725020 [wandb_run.py:_on_init():2173] communicating current version
2023-08-04 14:15:22,278 INFO    MainThread:2725020 [wandb_run.py:_on_init():2182] got version response upgrade_message: "wandb version 0.15.8 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-08-04 14:15:22,278 INFO    MainThread:2725020 [wandb_init.py:init():789] starting run threads in backend
2023-08-04 14:15:24,901 INFO    MainThread:2725020 [wandb_run.py:_console_start():2152] atexit reg
2023-08-04 14:15:24,901 INFO    MainThread:2725020 [wandb_run.py:_redirect():2007] redirect: SettingsConsole.WRAP_RAW
2023-08-04 14:15:24,901 INFO    MainThread:2725020 [wandb_run.py:_redirect():2072] Wrapping output streams.
2023-08-04 14:15:24,901 INFO    MainThread:2725020 [wandb_run.py:_redirect():2097] Redirects installed.
2023-08-04 14:15:24,902 INFO    MainThread:2725020 [wandb_init.py:init():830] run started, returning control to user process
2023-08-04 15:30:44,944 INFO    MainThread:2725020 [wandb_run.py:_config_callback():1281] config_cb ('_wandb', 'visualize', 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_BLEU') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/histogram/v0', 'fieldSettings': {'value': 'BLEU'}, 'stringSettings': {'title': 'BLEU Histogram'}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_BLEU_table'}], 'fields': []}]}]}}} None
2023-08-04 15:30:45,173 INFO    MainThread:2725020 [wandb_run.py:_config_callback():1281] config_cb ('_wandb', 'visualize', 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_1') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/histogram/v0', 'fieldSettings': {'value': 'ROUGE_1'}, 'stringSettings': {'title': 'ROUGE_1 Histogram'}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_1_table'}], 'fields': []}]}]}}} None
2023-08-04 15:30:45,422 INFO    MainThread:2725020 [wandb_run.py:_config_callback():1281] config_cb ('_wandb', 'visualize', 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_2') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/histogram/v0', 'fieldSettings': {'value': 'ROUGE_2'}, 'stringSettings': {'title': 'ROUGE_2 Histogram'}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_2_table'}], 'fields': []}]}]}}} None
2023-08-04 15:30:45,667 INFO    MainThread:2725020 [wandb_run.py:_config_callback():1281] config_cb ('_wandb', 'visualize', 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_L') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/histogram/v0', 'fieldSettings': {'value': 'ROUGE_L'}, 'stringSettings': {'title': 'ROUGE_L Histogram'}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'test-256-0.8-llama-7b-hf-Lora-Data_Science_and_Machine_Learning_class-bs_16-lr_5e-05-m_l_1280-m_p_l_768-w_decay_0.2_ROUGE_L_table'}], 'fields': []}]}]}}} None
2023-08-04 15:30:46,105 INFO    MainThread:2725020 [wandb_run.py:_finish():1887] finishing run razin_x_aleks/SRC_QC4QA/wxvy9kup
2023-08-04 15:30:46,105 INFO    MainThread:2725020 [wandb_run.py:_atexit_cleanup():2121] got exitcode: 0
2023-08-04 15:30:46,105 INFO    MainThread:2725020 [wandb_run.py:_restore():2104] restore
2023-08-04 15:30:46,105 INFO    MainThread:2725020 [wandb_run.py:_restore():2110] restore done
2023-08-04 15:31:06,789 INFO    MainThread:2725020 [wandb_run.py:_footer_history_summary_info():3464] rendering history
2023-08-04 15:31:06,789 INFO    MainThread:2725020 [wandb_run.py:_footer_history_summary_info():3496] rendering summary
2023-08-04 15:31:06,791 INFO    MainThread:2725020 [wandb_run.py:_footer_sync_info():3423] logging synced files
