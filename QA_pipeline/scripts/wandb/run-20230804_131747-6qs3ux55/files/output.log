Found cached dataset json (/home/st-aleksandr-razin/.cache/huggingface/datasets/RazinAleks___json/RazinAleks--SO-Python_QA-Data_Science_and_Machine_Learning_class-81f83bcd8b3cf0a9/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96)
Loading cached processed dataset at /home/st-aleksandr-razin/.cache/huggingface/datasets/RazinAleks___json/RazinAleks--SO-Python_QA-Data_Science_and_Machine_Learning_class-81f83bcd8b3cf0a9/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-5d734272de693c1c.arrow
  0%|                                                                                                                                                                                             | 0/56 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/test_script.py", line 99, in <module>
    main()
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/scripts/test_script.py", line 83, in main
    eval_model(
  File "/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/models/test_model.py", line 127, in eval_model
    output_tokens = generate_outputs(model, batch_ids, generation_config)
  File "/home/st-aleksandr-razin/workspace/SRC_QC4QA/QA_pipeline/models/test_model.py", line 39, in generate_outputs
    model.generate(
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/peft/peft_model.py", line 912, in generate
    outputs = self.base_model.generate(**kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/transformers/generation/utils.py", line 1577, in generate
    return self.sample(
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/transformers/generation/utils.py", line 2629, in sample
    outputs = self(
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 690, in forward
    outputs = self.model(
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 531, in forward
    inputs_embeds = self.embed_tokens(input_ids)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/st-aleksandr-razin/.conda/envs/qc4qa/lib/python3.10/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:1! (when checking argument for argument index in method wrapper_CUDA__index_select)